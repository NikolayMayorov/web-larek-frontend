### BasketModel

`BasketModel` управляет функциональностью корзины покупок.

```typescript
class BasketModel extends EventEmitter implements IBasketModel {
	// Управляет коллекцией товаров в корзине покупок
	// Генерирует события 'basket:changed' при изменении корзины
}
```

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура

Проект имеет MVP архитектуру

## Ключевые типы данных

### События

basket:delete - удаление еденицы товара из корзины
basket:open - открытиые корзины
basket:order - нажатие кнопки Оформить заказ
basket:changed - изменение состава корзины
modal:close - закрытие модального окна
modal:open - открытие модального окна
catalog:click - клик по товару в каталоге
catalog:changed - изменение каталога, например получение данных с сервера
order:payment - выбор способа оплаты заказа
order:next - переход к шагу ввода контактных данных
contacts:pay - нажатие кнопки Оплатить

### Интерфейс IProduct.

Определяет свойства товара.

#### Поля интерфейса:

- `id: string` - уникальный идентификатор товара
- `description: string` - подробное текстовое описание товара
- `image: string` - путь или URL к изображению товара
- `title: string` - название товара
- `category: string` - категория, к которой относится товар
- `price: number | null` - цена товара

### Перечисление PaymentMethod.

Определяет доступные способы оплаты:

- `Card` - оплата картой
- `Cash` - оплата наличными

### Класс Order.

Определяет объект заказа для отправки.
Конструктор принимает все поля класса в качестве аргументов и инициализирует их.

### Класс EventEmitter

#### Поля класса:

- `protected payment: string` - способ оплаты
- `protected email: string` - адрес электронной почты
- `protected phone: string` - номер телефона
- `protected address: string` - адрес доставки
- `protected total: number` - общая стоимость всех товаров в заказе
- `protected items: string[]` - массив идентификаторов товара

## Представления (Слой представлений)

1. Класс BaseProductView
   Это абстрактный базовый класс, который определяет общую структуру и функциональность для всех представлений товаров.
   - Класс имеет такие методы:
     render(item: IProduct).
2. Класс ProductCatalogView
   Служит для отображения товара в общем каталоге.
3. Класс ProductPreviewView
   Служит для отображения товара в превью.
4. Класс ProductBasketView
   Служит для отображения товара в корзине.
5. Класс BasketView
   Служит для отображения корзины.
   - Класс имеет такие методы:
     render().
6. Класс OrderView
   Служит для отображения окна заказа - выбор способа оплаты и ввод адреса доставки.
   - Класс имеет такие методы:
     render().
7. Класс ContactsView
   Служит для отображения окна ввода контактов - ввод адреса электронной почты и номера телефона.
   - Класс имеет такие методы:
     render().
8. SuccessView
   Служит для отображения ока с информацией об успешной отправки заказа.
   - Класс имеет такие методы:
     render().
9. SuccessView
   Служит для отображения ока с информацией об успешной отправки заказа.
   - Класс имеет такие методы:
     render().

## Модели данных (Слой данных)

### 1. Класс CatalogModel

Определяет список всех товаров.
Доступ к товарам оуществляется через геттеры и сеттеры.

#### Поля класса:

- `protected _products: IProduct[]` - массив товаров

#### Методы класса:

- `getProduct(id: string): IProduct | undefined` - возвращает товар по id

### 2. Класс BasketModel

Определяет состояние и методы корзины.

#### Поля класса:

- `protected _products: IProduct[]` - массив товаров в корзине

#### Методы класса:

- `addProduct(product: IProduct): void` - добавляет товар в корзину
- `removeProduct(product: IProduct): void` - удаляет товар из корзины
- `getProductCount(): number` - возвращает общее количество товаров в корзине
- `getTotalPrice(): number` - возвращает общую стоимость всех товаров в корзине
- `clearBasket(): void` - очищает массив товаров в корзине

### 3. Класс OrderModel

Определяет параметры для оформления заказа.

#### Поля класса:

- `protected _paymentMethod: PaymentMethod` - способ оплаты
- `protected _address: string` - адрес доставки
- `protected _email: string` - email
- `protected _phone: string` - телефон

#### Методы класса:

- `createOrder(total: number, items: string[]): IOrder` - создает экземпляр заказа
- `validateEmail(email: string): boolean` - валидация поля email
- `validatePhone(phone: string): boolean` - валидация поля phone
- `validateAddress(address: string): boolean` - валидация поля address

6. Класс OrderDetailView
   Служит для отображения и ввода параметров для оформления заказа.

- Класс имеет такие методы:
  buy - оплачивание заказа (отправка заказа)

Иерархия классов
Классы
BaseProductView
BaseProductView — это абстрактный базовый класс, который определяет общую структуру и функциональность для всех представлений товаров.

Защищенные поля:
\_productElement: HTMLElement — контейнер для всей карточки товара
\_titleElement: HTMLElement — элемент для отображения названия товара
\_priceElement: HTMLElement — элемент для отображения цены товара
\_id: string — уникальный идентификатор товара
\_events: EventEmitter — экземпляр системы событий для коммуникации
Методы:
abstract render(item: IProduct): HTMLElement — абстрактный метод, который должен быть реализован в подклассах для отображения товара
get id(): string — геттер для получения идентификатора товара
Конструктор:
Принимает HTML-шаблон, идентификатор и экземпляр EventEmitter. Клонирует шаблон и инициализирует основные элементы DOM.

ProductCatalogView
ProductCatalogView расширяет BaseProductView и предназначен для отображения товаров в контексте каталога.

Дополнительные защищенные поля:
\_imageElement: HTMLElement — элемент для отображения изображения товара
\_categoryElement: HTMLElement — элемент для отображения категории товара
Методы:
render(item: IProduct): HTMLElement — реализация метода для отображения товара в каталоге
Особенности:
Отображает категорию товара с соответствующим классом CSS на основе карты категорий
Форматирует цену с суффиксом "синапсов" или отображает "Бесценно" при отсутствии цены
Настраивает атрибуты изображения (src и alt)
ProductPreview
ProductPreview расширяет ProductCatalogView и предназначен для детального просмотра товара, включая описание и кнопку действия.

Дополнительные защищенные поля:
\_descriptionElement: HTMLElement — элемент для отображения описания товара
\_buttonElement: HTMLButtonElement — кнопка действия (например, "Добавить в корзину")
Методы:
render(item: IProduct): HTMLElement — переопределенная реализация для детального представления товара
Особенности:
Добавляет обработчик события для кнопки, который генерирует событие 'productAction' с идентификатором товара
Отображает полное описание товара
ProductBasketView
ProductBasketView расширяет базовый класс BaseProductView и предназначен для отображения товаров в корзине покупок.

Дополнительные защищенные поля:
\_deleteElement: HTMLButtonElement — кнопка для удаления товара из корзины
\_indexElement: HTMLButtonElement — элемент для отображения порядкового номера товара в корзине
Конструктор:
Принимает дополнительный параметр index для отображения порядкового номера товара.

Методы:
render(item: IProduct): HTMLElement — упрощенная реализация для отображения товара в корзине
Особенности:
Отображает порядковый номер товара в корзине
Добавляет обработчик события для кнопки удаления, который генерирует событие 'basket:delete' с идентификатором товара
Отображает только название и цену товара (без изображения и описания)
Взаимодействие через события
Модуль использует систему событий (EventEmitter) для коммуникации с другими компонентами приложения:

Событие Описание Данные Генерирующий класс
productAction Клик по кнопке действия товара { id: string } ProductPreview
basket:delete Клик по кнопке удаления товара { id: string } ProductBasketView
Пример использования
Возможные улучшения
Рефакторинг для устранения дублирования кода

Метод render в ProductPreview дублирует большую часть логики из ProductCatalogView
Можно вынести общую логику в родительский класс и использовать шаблон метода
Добавление типизации для элементов DOM

Использование более конкретных типов вместо общего HTMLElement для улучшения типобезопасности
Расширение функциональности

Добавление методов для обновления отдельных аспектов представления
Поддержка дополнительных интерактивных элементов (избранное, сравнение и т.д.)
Улучшение обработки ошибок

Добавление проверок на отсутствие элементов в шаблоне
Реализация стратегии обработки ошибок для некорректных данных
Заключение
Модуль Product.ts предоставляет гибкую и расширяемую систему для отображения товаров в различных контекстах приложения. Используя принципы ООП и событийно-ориентированную архитектуру, система обеспечивает эффективное разделение ответственности и слабую связанность компонентов.
